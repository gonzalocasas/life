---
const startDate = new Date('1985-04-26');
const currentDate = new Date('2025-02-24');

// Calculate complete years
const completeYears = Math.floor((currentDate - startDate) / (365.25 * 24 * 60 * 60 * 1000));
const completeYearWeeks = completeYears * 52;

// Calculate remaining weeks in current year
const yearStartDate = new Date(startDate);
yearStartDate.setFullYear(yearStartDate.getFullYear() + completeYears);
const remainingWeeks = Math.floor((currentDate - yearStartDate) / (7 * 24 * 60 * 60 * 1000));

// Total weeks lived
const weeksLived = completeYearWeeks + remainingWeeks;
---

<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="viewport" content="width=device-width" />
		<meta name="generator" content={Astro.generator} />
		<title>Î— Î¶Ï‰Î® Î¼Î¿Ï… ÏƒÎµ ÎµÎ²Î´Î¿Î¼Î¬Î´ÎµÏ‚</title>
		<style>
			:root {
				--square-size: 12px;
				--square-gap: 3px;
				--group-gap: 8px;
				--dot-size: 3px;
				--text-color: #262626;
			}

			body {
				background: white;
				margin: 0;
				padding: 2rem;
				font-family: Palatino,Palatino Linotype,Palatino LT STD,Book Antiqua,Georgia,serif; 
			}

			.title {
				font-size: 3rem;
				text-align: center;
				margin-bottom: 2rem;
				font-weight: lighter;
			}

			.container, .header-container {
				display: flex;
				flex-direction: column;
				align-items: center;
				gap: var(--square-gap);
				position: relative;
				margin:  0 2rem 0 2rem;
			}

			.header-container {
				margin: 0rem 0rem;
			}

			.week-label {
				color: var(--text-color);
				font-size: 10px;
				position: relative;
				top: -10px;
			}

			.year-label {
				min-width: 25px;
				text-align: right;
				margin-right: 10px;
				font-size: 10px;
				color: var(--text-color);
				visibility: visible;
			}

			.footer {
				text-align: center;
				margin-top: 3rem;
				color: var(--text-color);
				font-size: 0.7rem;
			}

			.heart {
				font-size: 0.7rem;
				margin-bottom: 0.5rem;
			}

			.row {
				display: flex;
				gap: var(--square-gap);
				align-items: center;
			}

			.week {
				width: var(--square-size);
				height: var(--square-size);
				border: 1px solid black;
				border-radius: 3px;
				flex-shrink: 0;
			}
			.header-row {
				justify-content: flex-start;
				padding-left: 2px;
				padding-bottom: 15px;
				color: var(--text-color);
				font-size: 10px;
			}

			.week.header {
				height: 0;
				border-color: white;
				position: relative;
			}

			.lived {
				background: black;
			}
			
			.last-weeks {
				width: var(--dot-size);
				height: var(--dot-size);
				margin: calc((var(--square-size) - var(--dot-size)) / 2);
			}


			/* Add extra gap for months (every 4 weeks) */
			.week:nth-child(4n + 2) {
				margin-left: var(--group-gap);
			}

			/* Add extra gap for decades (every 10 years) */
			.row:nth-child(10n + 1):not(:first-child) {
				margin-top: var(--group-gap);
			}
		</style>
	</head>
	<body>
		<h1 class="title">Î— Î¶Ï‰Î® Î¼Î¿Ï… ÏƒÎµ ÎµÎ²Î´Î¿Î¼Î¬Î´ÎµÏ‚</h1>
		<div class="header-container">
			<div class="grid row header-row">weeks</div>
			<div class="grid row">
				<div class="week header"></div>
				<div class="week header"></div>

				{Array.from({ length: 52 }).map((_, colIndex) => {
					const addWeekHeader = colIndex === 0 || ((colIndex + 1) % 4 === 0);
					return (
						<div class="week header">
							{addWeekHeader && <div class="week-label">{colIndex + 1}</div>}
						</div>
					);
				})}
			</div>
		</div>
		<div class="container">
			{Array.from({ length: 88 }).map((_, rowIndex) => (
				<div class="grid row">
					<div class="year-label" style={`visibility: ${rowIndex % 5 === 0 ? 'visible' : 'hidden'}`}>
						{rowIndex}
					</div>
					{Array.from({ length: 52 }).map((_, colIndex) => {
						const weekNumber = rowIndex * 52 + colIndex;
						const lastWeeks = rowIndex === 87 && colIndex >= 49;
						return (
							<div 
								class={`week ${weekNumber < weeksLived ? 'lived' : ''} ${lastWeeks ? 'last-weeks' : ''}`}
								title={`Week ${weekNumber + 1}`}
							/>
						);
					})}
				</div>
			))}
		</div>

		<div class="footer">
			<div class="heart">ðŸ’œ</div>
			<div>Made for Katerina with love</div>
		</div>
	</body>
</html>
